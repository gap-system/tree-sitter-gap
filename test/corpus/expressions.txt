=====================================
Identifiers
=====================================

foo;
Bar;
bAz1;
hello_world;
helloWorld;
n2;
2n;
42n;
hello\ world;
\+;
\[\];
123\ 456;
123\a456;
123\456;
1\.1;
1\.1\.2;

---
(source_file
    (identifier)
    (identifier)
    (identifier)
    (identifier)
    (identifier)
    (identifier)
    (identifier)
    (identifier)
    (identifier)
    (identifier)
    (identifier)
    (identifier)
    (identifier)
    (identifier)
    (identifier)
    (identifier)
)

=====================================
Lists
=====================================

[   ];
[ 1 ];
[ 1, 2 ];
[ 1, 2, ];
[  ,   ];
[  , 2 ];
[ 0, [ 1, 2 ], 3, 4 ];
[ 0, [  , 2 ],  , 4 ];

---

(source_file
  (list_expression)
  (list_expression (integer))
  (list_expression (integer) (integer))
  (list_expression (integer) (integer))
  (list_expression)
  (list_expression (integer))
  (list_expression (integer) (list_expression (integer) (integer)) (integer) (integer))
  (list_expression (integer) (list_expression (integer)) (integer))
  )

=====================================
Ranges
=====================================

[1..10];
[1,3..11];
[1,-1..-11];
[1.. 10];
[1 .. 10];
[1, 3..11];
[1,3 ..11];
[1,3.. 11];
[1, 3 .. 11];
---

(source_file
    (range_expression (integer) (integer))
    (range_expression (integer) (integer) (integer))
    (range_expression (integer) (unary_expression (integer)) (unary_expression (integer)))
    (range_expression (integer) (integer))
    (range_expression (integer) (integer))
    (range_expression (integer) (integer) (integer))
    (range_expression (integer) (integer) (integer))
    (range_expression (integer) (integer) (integer))
    (range_expression (integer) (integer) (integer)))

=====================================
Records
=====================================

rec();
rec(,);
rec(a:=1);
rec( a := 1 );
rec(a:=1,);
rec(1:=2);
rec(a:=1, b:=2);
rec(a:=1, b:=2, );
rec(a:=1, b:=2, (1+1):=3);
rec(a:=1, b:=2, (Concatenation("a", "b")):=1+1);

---

(source_file
  (record_expression)
  (record_expression)
  (record_expression
    (record_entry
        (identifier)
        (integer)))
  (record_expression
    (record_entry
        (identifier)
        (integer)))
  (record_expression
    (record_entry
        (identifier)
        (integer)))
  (record_expression
    (record_entry
        (integer)
        (integer)))
  (record_expression
    (record_entry
        (identifier)
        (integer))
    (record_entry
        (identifier)
        (integer)))
  (record_expression
    (record_entry
        (identifier)
        (integer))
    (record_entry
        (identifier)
        (integer)))
  (record_expression
    (record_entry
        (identifier)
        (integer))
    (record_entry
        (identifier)
        (integer))
    (record_entry
        (parenthesized_expression
            (binary_expression
                (integer)
                (integer)))
        (integer)))
  (record_expression
    (record_entry
        (identifier)
        (integer))
    (record_entry
        (identifier)
        (integer))
    (record_entry
        (parenthesized_expression
            (call
                (identifier)
                (argument_list
                    (string)
                    (string))))
        (binary_expression
            (integer)
            (integer))))
)

=====================================
Permutations
=====================================

();
(1,2);
(1,2,3);
(1,2)(3,4,5);

---

(source_file
  (permutation_expression)
  (permutation_expression
    (permutation_cycle_expression
      (integer)
      (integer)))
  (permutation_expression
    (permutation_cycle_expression
      (integer)
      (integer)
      (integer)))
  (permutation_expression
    (permutation_cycle_expression
      (integer)
      (integer))
    (permutation_cycle_expression
      (integer)
      (integer)
      (integer)))
  )

=====================================
List selectors
=====================================

A[1];
A[b];
A[3];
A[1+1];
A[1+Sum([1,2,3])];
A[1][2];
A[1+1][2];
A[B[1]][2][3];
A[1,2];
A[1,Sum([1,2])];
A [1];
A [1] [2];
A[2]{[1,2,3]};
A[1](2);
A[1]();

---

(source_file
    (list_selector
        (identifier)
        (integer))
    (list_selector
        (identifier)
        (identifier))
    (list_selector
        (identifier)
        (integer))
    (list_selector
        (identifier)
        (binary_expression
            (integer)
            (integer)))
    (list_selector
        (identifier)
        (binary_expression
            (integer)
            (call
                (identifier)
                (argument_list
                    (list_expression
                        (integer)
                        (integer)
                        (integer))))))
    (list_selector
        (list_selector
            (identifier)
            (integer))
        (integer))
    (list_selector
        (list_selector
            (identifier)
            (binary_expression
                (integer)
                (integer)))
        (integer))
    (list_selector
        (list_selector
            (list_selector
                (identifier)
                (list_selector
                    (identifier)
                    (integer)))
            (integer))
        (integer))
    (list_selector
        (identifier)
        (integer)
        (integer))
    (list_selector
        (identifier)
        (integer)
        (call
            (identifier)
            (argument_list
                (list_expression
                    (integer)
                    (integer)))))
    (list_selector
        (identifier)
        (integer))
    (list_selector
        (list_selector
            (identifier)
            (integer))
        (integer))
    (sublist_selector
        (list_selector
            (identifier)
            (integer))
        (list_expression
            (integer)
            (integer)
            (integer)))
    (call
        (list_selector
            (identifier)
            (integer))
        (argument_list
            (integer)))
    (call
        (list_selector
            (identifier)
            (integer))
        (argument_list))
)

=====================================
Sublist selectors
=====================================

A{[1]};
A{[2,3]};
A{[1+1,1]};
A{x};
A{[1..10]};
A{List([1..10],x->1)};
A{[1,2,3]}[1];
A{[1,2,3]}[1,1];
A{[1,2,3]}{[4,5,6]};
A{[1,2,3]}(1,2);
A{[2,2,3]}();


---

(source_file
    (sublist_selector
        (identifier)
        (list_expression
            (integer)))
    (sublist_selector
        (identifier)
        (list_expression
            (integer)
            (integer)))
    (sublist_selector
        (identifier)
        (list_expression
            (binary_expression
                (integer)
                (integer))
            (integer)))
    (sublist_selector
        (identifier)
        (identifier))
    (sublist_selector
        (identifier)
        (range_expression
            (integer)
            (integer)))
    (sublist_selector
        (identifier)
        (call
            (identifier)
            (argument_list
                (range_expression
                    (integer)
                    (integer))
                (lambda
                    (lambda_parameters
                        (identifier))
                    (integer)))))
    (list_selector
        (sublist_selector
            (identifier)
            (list_expression
                (integer)
                (integer)
                (integer)))
        (integer))
    (list_selector
        (sublist_selector
            (identifier)
            (list_expression
                (integer)
                (integer)
                (integer)))
        (integer)
        (integer))
    (sublist_selector
        (sublist_selector
            (identifier)
            (list_expression
                (integer)
                (integer)
                (integer)))
        (list_expression
            (integer)
            (integer)
            (integer)))
    (call
        (sublist_selector
            (identifier)
            (list_expression
                (integer)
                (integer)
                (integer)))
        (argument_list
            (integer)
            (integer)))
    (call
        (sublist_selector
            (identifier)
            (list_expression
                (integer)
                (integer)
                (integer)))
        (argument_list))
)

=====================================
Positional selectors
=====================================

A![1];
A![1+1];
A![n];
A![n](1,3);
A![n]();

---

(source_file
    (positional_selector
        (identifier)
        (integer))
    (positional_selector
        (identifier)
        (binary_expression
            (integer)
            (integer)))
    (positional_selector
        (identifier)
        (identifier))
    (call
        (positional_selector
            (identifier)
            (identifier))
        (argument_list
            (integer)
            (integer)))
    (call
        (positional_selector
            (identifier)
            (identifier))
        (argument_list))
)

=====================================
Record selectors
=====================================

A.1;
A.1.2;
A.(1+1);
A.hello;
A.hello.1;
A.1.world;
A.hello.world;
A.hello.world.foo;
A.hello.world[1];
A.hello.world{[1,2,3]};
A.(Concatenation("a", "b"));
A.("ab");
A.hello();
A.hello(1);
A.hello.world();
A.hello.world(1);
A.("ab")(1,2);
A.1(2);

---

(source_file
    (record_selector
        (identifier)
        (integer))
    (record_selector
        (record_selector
            (identifier)
            (integer))
        (integer))
    (record_selector
        (identifier)
        (parenthesized_expression
            (binary_expression
                (integer)
                (integer))))
    (record_selector
        (identifier)
        (identifier))
    (record_selector
        (record_selector
            (identifier)
            (identifier))
        (integer))
    (record_selector
        (record_selector
            (identifier)
            (integer))
        (identifier))
    (record_selector
        (record_selector
            (identifier)
            (identifier))
        (identifier))
    (record_selector
        (record_selector
            (record_selector
                (identifier)
                (identifier))
            (identifier))
        (identifier))
    (list_selector
        (record_selector
            (record_selector
                (identifier)
                (identifier))
            (identifier))
        (integer))
    (sublist_selector
        (record_selector
            (record_selector
                (identifier)
                (identifier))
            (identifier))
        (list_expression
            (integer)
            (integer)
            (integer)))
    (record_selector
        (identifier)
        (parenthesized_expression
            (call
                (identifier)
                (argument_list
                    (string)
                    (string)))))
    (record_selector
        (identifier)
        (parenthesized_expression
            (string)))
    (call
        (record_selector
            (identifier)
            (identifier))
        (argument_list))
    (call
        (record_selector
            (identifier)
            (identifier))
        (argument_list
            (integer)))
    (call
        (record_selector
            (record_selector
                (identifier)
                (identifier))
            (identifier))
        (argument_list))
    (call
        (record_selector
            (record_selector
                (identifier)
                (identifier))
            (identifier))
        (argument_list
            (integer)))
    (call
        (record_selector
            (identifier)
            (parenthesized_expression
                (string)))
        (argument_list
            (integer)
            (integer)))
    (call
        (record_selector
            (identifier)
            (integer))
        (argument_list
            (integer)))
)

=====================================
Component selectors
=====================================

A!.1;
A!.1!.2;
A!.(1+1);
A!.hello;
A!.hello.world;
A!.hello!.world!.foo;
A.hello!.world[1];
A!.hello!.world{[1,2,3]};
A!.(Concatenation("a", "b"));
A!.("ab");
A!.hello();
A!.hello(1);
A!.hello!.world();
A!.hello!.world(1);
A!.("ab")(1,2);
A!.1();

---

(source_file
    (component_selector
        (identifier)
        (integer))
    (component_selector
        (component_selector
            (identifier)
            (integer))
        (integer))
    (component_selector
        (identifier)
        (parenthesized_expression
            (binary_expression
                (integer)
                (integer))))
    (component_selector
        (identifier)
        (identifier))
    (record_selector
        (component_selector
            (identifier)
            (identifier))
        (identifier))
    (component_selector
        (component_selector
            (component_selector
                (identifier)
                (identifier))
            (identifier))
        (identifier))
    (list_selector
        (component_selector
            (record_selector
                (identifier)
                (identifier))
            (identifier))
        (integer))
    (sublist_selector
        (component_selector
            (component_selector
                (identifier)
                (identifier))
            (identifier))
        (list_expression
            (integer)
            (integer)
            (integer)))
    (component_selector
        (identifier)
        (parenthesized_expression
            (call
                (identifier)
                (argument_list
                    (string)
                    (string)))))
    (component_selector
        (identifier)
        (parenthesized_expression
            (string)))
    (call
        (component_selector
            (identifier)
            (identifier))
        (argument_list))
    (call
        (component_selector
            (identifier)
            (identifier))
        (argument_list
            (integer)))
    (call
        (component_selector
            (component_selector
                (identifier)
                (identifier))
            (identifier))
        (argument_list))
    (call
        (component_selector
            (component_selector
                (identifier)
                (identifier))
            (identifier))
        (argument_list
            (integer)))
    (call
        (component_selector
            (identifier)
            (parenthesized_expression
                (string)))
        (argument_list
            (integer)
            (integer)))
    (call
        (component_selector
            (identifier)
            (integer))
        (argument_list))
)

=====================================
Functions
=====================================

function() end;
function(a) end;
function(a,b) end;
function(a...) end;
function(a,b...) end;

function()
    local x;
end;

function()
    return 1;
end;
function(a)
    return a;
end;
function()
    local x;
    return 1;
end;

---

(source_file
    (function (parameters))
    (function (parameters (identifier)))
    (function (parameters (identifier) (identifier)))
    (function (parameters (identifier) (ellipsis)))
    (function (parameters (identifier) (identifier) (ellipsis)))
    (function (parameters) (locals (identifier)))
    (function (parameters) (block (return_statement (integer))))
    (function (parameters (identifier)) (block (return_statement (identifier))))
    (function (parameters) (locals (identifier)) (block (return_statement (integer))))
    )   

=====================================
Inline Functions
=====================================

x -> 1;

x -> y -> 1;

x -> y -> x + y;

{} -> 42;

{x,y} -> x + y;

{x...} -> x;

---

(source_file
    (lambda (lambda_parameters (identifier)) (integer))
    (lambda (lambda_parameters (identifier)) (lambda (lambda_parameters (identifier)) (integer)))
    (lambda (lambda_parameters (identifier)) (lambda (lambda_parameters (identifier)) (binary_expression (identifier) (identifier))))
    (lambda (lambda_parameters) (integer))
    (lambda (lambda_parameters (identifier) (identifier)) (binary_expression (identifier) (identifier)))
    (lambda (lambda_parameters (identifier) (ellipsis)) (identifier))
    )

=====================================
Function calls
=====================================

foo();

foo(1);

foo(1, 1);

foo(bar());

foo()();

foo(1)();

foo()(1);

foo(1)(1);

(foo)();

---

(source_file
    (call (identifier) (argument_list))
    (call (identifier) (argument_list (integer)))
    (call (identifier) (argument_list (integer) (integer)))
    (call (identifier) (argument_list (call (identifier) (argument_list))))
    (call 
        (call (identifier) (argument_list)) 
        (argument_list))
    (call 
        (call (identifier) (argument_list (integer))) 
        (argument_list))
    (call 
        (call (identifier) (argument_list))
        (argument_list (integer)))
    (call 
        (call (identifier) (argument_list (integer))) 
        (argument_list (integer)))
    (call 
        (parenthesized_expression (identifier)) 
        (argument_list))
)


=====================================
Function calls with options
=====================================

Size( fpgrp : hard, tcselection := "external" );
Size(fpgrp: hard, tcselection:= "external");
f(a, 1 : c, d:=1, f);
f(a, 1 : c, d:=1, f, g:=3, h:="aa");
f(a, 1 : d:=1, g:=3, h:="aa");
f(: c, d:=1, f);
f(a, b:);
f(:);
f(:a);
f(:a:=b);
# Need to fix floats for these to work
#f(.1:c,d:=1,f);
#(a,.1:c,d:=1,f);
# f(a, 1. : c, d:=1, f)
# f(a,1.:c,d:=1,f)
# f(1.:c,d:=1,f)
f(1:(1+1),d:=1,f);
f(1:c,(1+1):=1,f);

---

(source_file
    (call
        (identifier)
        (argument_list
            (identifier)
            (function_call_option
                (identifier))
            (function_call_option
                (record_entry
                    (identifier)
                    (string)))))
    (call
        (identifier)
        (argument_list
            (identifier)
            (function_call_option
                (identifier))
            (function_call_option
                (record_entry
                    (identifier)
                    (string)))))
    (call
        (identifier)
        (argument_list
            (identifier)
            (integer)
            (function_call_option
                (identifier))
            (function_call_option
                (record_entry
                    (identifier)
                    (integer)))
            (function_call_option
                (identifier))))
    (call
        (identifier)
        (argument_list
            (identifier)
            (integer)
            (function_call_option
                (identifier))
            (function_call_option
                (record_entry
                    (identifier)
                    (integer)))
            (function_call_option
                (identifier))
            (function_call_option
                (record_entry
                    (identifier)
                    (integer)))
            (function_call_option
                (record_entry
                    (identifier)
                    (string)))))
    (call
        (identifier)
        (argument_list
            (identifier)
            (integer)
            (function_call_option
                (record_entry
                    (identifier)
                    (integer)))
            (function_call_option
                (record_entry
                    (identifier)
                    (integer)))
            (function_call_option
                (record_entry
                    (identifier)
                    (string)))))
    (call
        (identifier)
        (argument_list
            (function_call_option
                (identifier))
            (function_call_option
                (record_entry
                    (identifier)
                    (integer)))
            (function_call_option
                (identifier))))
    (call
        (identifier)
        (argument_list
            (identifier)
            (identifier)))
    (call
        (identifier)
        (argument_list))
    (call
        (identifier)
        (argument_list
            (function_call_option
                (identifier))))
    (call
        (identifier)
        (argument_list
            (function_call_option
                (record_entry
                    (identifier)
                    (identifier)))))
    (comment)
    (comment)
    (comment)
    (comment)
    (comment)
    (comment)
    (call
        (identifier)
        (argument_list
            (integer)
            (function_call_option
                (parenthesized_expression
                    (binary_expression
                        (integer)
                        (integer))))
            (function_call_option
                (record_entry
                    (identifier)
                    (integer)))
            (function_call_option
                (identifier))))
    (call
        (identifier)
        (argument_list
            (integer)
            (function_call_option
                (identifier))
            (function_call_option
                (record_entry
                    (parenthesized_expression
                        (binary_expression
                            (integer)
                            (integer)))
                    (integer)))
            (function_call_option
                (identifier))))
)
